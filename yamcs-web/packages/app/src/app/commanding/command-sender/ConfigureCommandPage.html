<app-instance-page>
  <app-instance-toolbar>
    Send a command
  </app-instance-toolbar>

  <app-send-command-wizard-step step="2"></app-send-command-wizard-step>

  <div class="form-content">
    <h3>{{ (command$ | async)?.qualifiedName }}</h3>
    <form [formGroup]="commandConfigurationForm"
          class="ya-form"
          [class.showAll]="showAll$ | async">
      <ng-container *ngFor="let argument of arguments">
        <ng-container [ngSwitch]="argument.type?.engType">

          <label *ngSwitchCase="'enumeration'" [class.hasInitial]="argument.initialValue !== undefined">
            {{ argument.name }}
            <select [formControlName]="argument.name">
              <option *ngFor="let enumValue of argument.type.enumValue" [value]="enumValue.label">
                {{ enumValue.label }}</option>
            </select>
          </label>

          <label *ngSwitchCase="'boolean'" [class.hasInitial]="argument.initialValue !== undefined">
            {{ argument.name }}<br>
            <input type="radio" [formControlName]="argument.name" value="true"> true
            <input type="radio" [formControlName]="argument.name" value="false"> false
          </label>

          <label *ngSwitchDefault [class.hasInitial]="argument.initialValue !== undefined">
            {{ argument.name }}
            <input type="text" [formControlName]="argument.name">
          </label>

        </ng-container>
      </ng-container>
      <app-text-action (click)="showAll$.next(true)"
                       *ngIf="initialValueCount && !(showAll$ | async)"
                       icon="double_arrow">
        Show {{ initialValueCount }} argument<ng-container *ngIf="initialValueCount !== 1">s</ng-container> with
        defaults
      </app-text-action>
      <ng-container *ngIf="arguments.length">
        <br>
        <mat-divider style="margin-top: 1em; margin-bottom: 1em"></mat-divider>
      </ng-container>
      <label>
        Comment <span class="hint">(optional)</span>
        <textarea formControlName="_comment" rows="3" style="width: 100%; resize: none"></textarea>
      </label>
    </form>
    <p>&nbsp;</p>
    <mat-toolbar>
      <span style="flex: 1 1 auto"></span>
      <button mat-raised-button
              (click)="goBack()">
        Cancel
      </button>
      &nbsp;&nbsp;
      <button mat-raised-button color="primary"
              [disabled]="!commandConfigurationForm.valid"
              (click)="sendCommand()">
        <mat-icon>send</mat-icon>
        Send
      </button>
    </mat-toolbar>
  </div>
</app-instance-page>
