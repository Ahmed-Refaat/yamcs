<!doctype html>
<html>
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <link type="text/css" href="/_static/css/uss.css" rel="stylesheet"/>
  <link type="text/css" href="/_static/css/uss.dqi.css" rel="stylesheet"/>
  <link type="text/css" href="/_static/lib/css/jquery-ui-1.8.20.custom.css" rel="stylesheet" />
  <link type="text/css" href="/_static/lib/css/jquery.ui.menu.css" rel="stylesheet" />
  <link type="text/css" href="/_static/lib/css/jquery.ui.menubar.css" rel="stylesheet" />
  <link type="text/css" href="/_static/lib/css/jquery.window.css" rel="stylesheet" />

  <script src="/_static/lib/js/jquery-1.7.2.min.js"></script>
  <script src="/_static/lib/js/jquery.svg.js"></script>
  <script src="/_static/lib/js/highcharts.src.js"></script>
  <script src="/_static/lib/js/sprintf-0.7-beta1.js"></script>
  <script src="/_static/lib/js/jquery.ui.core.js"></script>
  <script src="/_static/lib/js/jquery.ui.widget.js"></script>
  <script src="/_static/lib/js/jquery.ui.mouse.js"></script>
  <script src="/_static/lib/js/jquery.ui.draggable.js"></script>
  <script src="/_static/lib/js/jquery.ui.resizable.js"></script>
  <script src="/_static/lib/js/jquery.ui.position.js"></script>
  <script src="/_static/lib/js/jquery.ui.button.js"></script>
  <script src="/_static/js/yamcs-ws.js"> </script>
  <script src="/_static/js/uss.js"> </script>
  <script src="/_static/js/uss.basic-widgets.js"> </script>
  <script src="/_static/js/uss.graph.js"> </script>
  <script src="/_static/js/uss.meters.js"> </script>
</head>
<body>
   <script>
     $(document).ready(function(){
         var p=location.pathname.split("/");
         var yamcsInstance = p[1];
         var filename = p[3];
         console.log(p);
         var div=document.getElementById('display-div');
         console.log("div: ", div);
         var webSocketClient = yamcsWebSocket(p[1]);
         webSocketClient.bindDataHandler('PARAMETER', function(pdata) {
             var params=pdata.parameter;
             for(var i=0; i<params.length; i++) {
                 var p=params[i];
                 var dbs = webSocketClient.subscribedParameters[p.id.name];
                 if(!dbs) {
                     console.log("cannot find bindings for "+ p.id.name, webSocketClient.subscribedParameters);
                     continue;
                 }
                 for(var j = 0; j < dbs.length; j++){
                     USS.updateWidget(dbs[j], p);
                 }
             }
         });
         USS.loadDisplay(div, filename, webSocketClient, null);
     });
   </script>
   <div id='display-div'>
   </div>
</body>
</html>
